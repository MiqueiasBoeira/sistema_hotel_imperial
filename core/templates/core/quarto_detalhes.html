{% extends 'core/base.html' %}

{% block title %}Quarto {{ quarto.numero_quarto }}{% endblock %}

{% block content %}
<h1>Detalhes do Quarto {{ quarto.numero_quarto }}</h1>

{% if quarto.estado == 'ocupado' %}
    <h2>Hóspede Atual</h2>
    <div class="hospede-detalhes">
        <p><strong>Nome:</strong> {{ quarto.hospede.nome_completo }}</p>
        <p><strong>CPF:</strong> {{ quarto.hospede.cpf }}</p>
        <p><strong>E-mail:</strong> {{ quarto.hospede.email }}</p>
        <p><strong>Telefone:</strong> {{ quarto.hospede.telefone }}</p>
        <p><strong>Endereço:</strong> {{ quarto.hospede.endereco }}</p>
        {% if quarto.tipo_checkin == 'empresa' %}
            <p><strong>Empresa:</strong> {{ quarto.checkin_empresa.empresa.nome_empresa }}</p>
        {% endif %}
        <h3>Check-in</h3>
        <p><strong>Data de Check-in:</strong>
            {% if quarto.checkin_individual %}
                {{ quarto.checkin_individual.data_checkin }}
            {% else %}
                {{ quarto.checkin_empresa.data_checkin }}
            {% endif %}
        </p>
        <p><strong>Data de Check-out:</strong>
            {% if quarto.checkin_individual %}
                {{ quarto.checkin_individual.data_checkout }}
            {% else %}
                {{ quarto.checkin_empresa.data_checkout }}
            {% endif %}
        </p>
        <p><strong>Diária:</strong>
            {% if quarto.checkin_individual %}
                {{ quarto.checkin_individual.diaria }}
            {% else %}
                {{ quarto.checkin_empresa.diaria }}
            {% endif %}
        </p>
        <p><strong>Número de Dias:</strong>
            {% if quarto.checkin_individual %}
                {{ quarto.checkin_individual.num_dias }}
            {% else %}
                {{ quarto.checkin_empresa.num_dias }}
            {% endif %}
        </p>
        <p><strong>Companhia:</strong>
            {% if quarto.checkin_individual %}
                {{ quarto.checkin_individual.companhia }}
            {% else %}
                {{ quarto.checkin_empresa.companhia }}
            {% endif %}
        </p>
        <p><strong>Motivo da Viagem:</strong>
            {% if quarto.checkin_individual %}
                {{ quarto.checkin_individual.motivo_viagem }}
            {% else %}
                {{ quarto.checkin_empresa.motivo_viagem }}
            {% endif %}
        </p>
        <p><strong>Acompanhantes:</strong>
            {% if quarto.checkin_individual %}
                {{ quarto.checkin_individual.acompanhantes }}
            {% else %}
                {{ quarto.checkin_empresa.acompanhantes }}
            {% endif %}
        </p>
    </div>
{% else %}
    <p>O quarto está atualmente livre.</p>
{% endif %}

<h2>Reservas Ativas</h2>
{% for reserva in reservas %}
<div class="reserva">
    <p>Hóspede: {% if reserva.hospede %}{{ reserva.hospede.nome_completo }}{% else %}{{ reserva.nome_hospede }}{% endif %}</p>
    <p>Contato: {% if reserva.hospede %}{{ reserva.hospede.telefone }}{% else %}{{ reserva.contato_hospede }}{% endif %}</p>
    <p>Data de Início: {{ reserva.data_inicio }}</p>
    <p>Data de Fim: {{ reserva.data_fim }}</p>
    <form method="post" action="{% url 'quarto_detalhes' quarto.id %}">
        {% csrf_token %}
        <input type="hidden" name="reserva_id" value="{{ reserva.id }}">
        <button type="submit" name="cancelar_reserva">Cancelar Reserva</button>
    </form>
</div>
{% empty %}
<p>Não há reservas para este quarto.</p>
{% endfor %}
{% endblock %}
